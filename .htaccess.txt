############################################
# Basic Security
############################################

# Disable directory listing
Options -Indexes

############################################
# Protect sensitive files (.env, configs, backups, git, composer, npm)
############################################
<FilesMatch "(^\.env$|\.env\.|\.ini$|\.log$|\.conf$|\.yaml$|\.yml$|\.sql$|\.bak$|\.old$|\.backup$|composer\.(json|lock)$|package(-lock)?\.json$|phpunit\.xml$|\.git|\.svn)">
    Require all denied
</FilesMatch>

############################################
# Block access to hidden files (except .well-known)
############################################
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# Allow ACME / security.txt
<DirectoryMatch "\.well-known">
    Require all granted
</DirectoryMatch>

############################################
# Prevent PHP execution in writable directories
############################################
<DirectoryMatch "(uploads|storage|logs|cache|tmp)">
    <FilesMatch "\.(php|php5|phtml|phar)$">
        Require all denied
    </FilesMatch>
</DirectoryMatch>

############################################
# MIME sniffing protection
############################################
Header always set X-Content-Type-Options "nosniff"

############################################
# Clickjacking protection
############################################
Header always set X-Frame-Options "SAMEORIGIN"

############################################
# XSS protection
############################################
Header always set X-XSS-Protection "1; mode=block"

############################################
# Referrer policy
############################################
Header always set Referrer-Policy "strict-origin-when-cross-origin"

############################################
# Error Pages (Absolute URLs â€“ safe)
############################################
ErrorDocument 400 https://qrbasedattendance.gt.tc/pages/400.php
ErrorDocument 401 https://qrbasedattendance.gt.tc/pages/401.php
ErrorDocument 403 https://qrbasedattendance.gt.tc/pages/403.php
ErrorDocument 404 https://qrbasedattendance.gt.tc/pages/404.php
ErrorDocument 405 https://qrbasedattendance.gt.tc/pages/405.php
ErrorDocument 408 https://qrbasedattendance.gt.tc/pages/408.php
ErrorDocument 500 https://qrbasedattendance.gt.tc/pages/500.php
ErrorDocument 502 https://qrbasedattendance.gt.tc/pages/502.php
ErrorDocument 503 https://qrbasedattendance.gt.tc/pages/503.php


# Disable error display (production)
php_flag display_errors Off

# Enable error logging
php_flag log_errors On

# Custom error log file
php_value error_log logs/error.log
